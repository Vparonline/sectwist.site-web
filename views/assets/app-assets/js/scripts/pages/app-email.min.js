"use strict";$((function(){var e=Quill.import("formats/font");e.whitelist=["sofia","slabo","roboto","inconsolata","ubuntu"],Quill.register(e,!0);var t=$(".compose-email"),o=$("#compose-mail"),s=$(".menu-toggle"),a=$(".sidebar-toggle"),l=$(".sidebar-left"),i=$(".sidebar-menu-list"),n=$(".email-app-list"),c=$(".email-user-list"),r=$(".email-user-list .form-check"),d=$(".email-scroll-area"),m=$("#email-to"),h=$("#emailCC"),f=$("#emailBCC"),p=$(".toggle-cc"),g=$(".toggle-bcc"),u=$(".cc-wrapper"),v=$(".bcc-wrapper"),k=$(".email-app-details"),w=$(".list-group-messages"),C=$(".go-back"),b=$(".email-application .email-favorite"),S=$(".user-action"),y=$(".mail-delete"),P=$(".mail-unread"),x=$("#email-search"),M=$(".modal"),z=$(".modal-dialog"),O=$("#message-editor .editor"),T=$(".body-content-overlay"),B=$(".compose-maximize"),D="rtl"===$("html").attr("data-textdirection"),L="../../../app-assets/";if("laravel"===$("body").attr("data-framework")&&(L=$("body").attr("data-asset-path")),v.length&&v.toggle(),u&&u.toggle(),g.length&&g.on("click",(function(){v.toggle()})),p.length&&p.on("click",(function(){u.toggle()})),$.app.menu.is_touch_device())$(i).css("overflow","scroll"),$(c).css("overflow","scroll"),$(d).css("overflow","scroll");else{if($(i).length>0)new PerfectScrollbar(i[0]);if($(c).length>0)new PerfectScrollbar(c[0]);if($(d).length>0)new PerfectScrollbar(d[0])}function Q(e){if(!e.id)return e.text;var t=feather.icons.user.toSvg({class:"me-0"});return $(e.element).data("avatar")&&(t="<img src='"+L+"images/avatars/"+$(e.element).data("avatar")+"' alt='avatar' />"),"<div class='d-flex flex-wrap align-items-center'><div class='avatar avatar-sm my-0 me-50'><span class='avatar-content'>"+t+"</span></div>"+e.text+"</div>"}if($(document).keyup((function(e){"Escape"===e.key&&o.find(".modal-dialog").hasClass("modal-fullscreen")&&B.click()})),m.length&&m.wrap('<div class="position-relative"></div>').select2({dropdownParent:m.parent(),closeOnSelect:!1,templateResult:Q,templateSelection:Q,tags:!0,tokenSeparators:[","," "],escapeMarkup:function(e){return e}}),h.length&&h.wrap('<div class="position-relative"></div>').select2({dropdownParent:h.parent(),closeOnSelect:!1,templateResult:Q,templateSelection:Q,tags:!0,tokenSeparators:[","," "],escapeMarkup:function(e){return e}}),f.length&&f.wrap('<div class="position-relative"></div>').select2({dropdownParent:f.parent(),closeOnSelect:!1,templateResult:Q,templateSelection:Q,tags:!0,tokenSeparators:[","," "],escapeMarkup:function(e){return e}}),t.length&&t.on("click",(function(){T.removeClass("show"),l.removeClass("show"),$(".compose-form input").val(""),m.val([]).trigger("change"),h.val([]).trigger("change"),f.val([]).trigger("change"),u.hide(),v.hide(),$(".compose-form .ql-editor")[0].innerHTML=""})),s.length&&s.on("click",(function(e){l.removeClass("show"),T.removeClass("show")})),a.length&&a.on("click",(function(e){e.stopPropagation(),l.toggleClass("show"),T.addClass("show")})),B&&B.on("click",(function(){M.toggleClass("modal-sticky"),z.toggleClass("modal-fullscreen"),z.hasClass("modal-fullscreen")?$(this).html(feather.icons["minimize-2"].toSvg()):$(this).html(feather.icons["maximize-2"].toSvg())})),T.length&&T.on("click",(function(e){l.removeClass("show"),T.removeClass("show")})),c.find("li").length&&c.find("li").on("click",(function(e){k.toggleClass("show")})),w.find("a").length&&w.find("a").on("click",(function(){w.find("a").hasClass("active")&&w.find("a").removeClass("active"),$(this).addClass("active")})),C.length&&C.on("click",(function(e){e.stopPropagation(),k.removeClass("show")})),b.length&&b.on("click",(function(e){$(this).find("svg").toggleClass("favorite"),e.stopPropagation(),$(this).find("svg").hasClass("favorite")&&toastr.success("Updated mail to favorite","Favorite Mail ⭐️",{closeButton:!0,tapToDismiss:!1,rtl:D})})),$(window).width()>768&&T.hasClass("show")&&T.removeClass("show"),r.length&&(r.on("click",(function(e){e.stopPropagation()})),r.find("input").on("change",(function(e){e.stopPropagation();var t=$(this);t.is(":checked")?t.closest(".user-mail").addClass("selected-row-bg"):t.closest(".user-mail").removeClass("selected-row-bg")}))),$(document).on("click",".email-app-list .selectAll input",(function(){$(this).is(":checked")?S.find(".form-check .form-check-input").prop("checked",this.checked).closest(".user-mail").addClass("selected-row-bg"):S.find(".form-check .form-check-input").prop("checked","").closest(".user-mail").removeClass("selected-row-bg")})),y.length&&y.on("click",(function(){S.find(".form-check .form-check-input:checked").length&&(S.find(".form-check .form-check-input:checked").closest(".user-mail").remove(),n.find(".selectAll input").prop("checked",!1),toastr.error("You have removed email.","Mail Deleted!",{closeButton:!0,tapToDismiss:!1,rtl:D}),S.find(".form-check .form-check-input").prop("checked",""))})),P.length&&P.on("click",(function(){S.find(".form-check .form-check-input:checked").closest(".user-mail").removeClass("mail-read")})),x.length&&x.on("keyup",(function(){var e=$(this).val().toLowerCase();""!==e?(c.find(".email-media-list li").filter((function(){$(this).toggle($(this).text().toLowerCase().indexOf(e)>-1)})),0==c.find(".email-media-list li:visible").length?(c.find(".no-results").addClass("show"),c.animate({scrollTop:"0"},500)):c.find(".no-results").hasClass("show")&&c.find(".no-results").removeClass("show")):(c.find(".email-media-list li").show(),c.find(".no-results").hasClass("show")&&c.find(".no-results").removeClass("show"))})),O.length)new Quill(O[0],{bounds:"#message-editor .editor",modules:{formula:!0,syntax:!0,toolbar:".compose-editor-toolbar"},placeholder:"Message",theme:"snow"});$(".nav-link-search, .bookmark-star").on("click",(function(){M.modal("hide")}))})),$(window).on("resize",(function(){var e=$(".sidebar-left");$(window).width()>768&&$(".app-content .body-content-overlay").hasClass("show")&&(e.removeClass("show"),$(".app-content .body-content-overlay").removeClass("show"))}));